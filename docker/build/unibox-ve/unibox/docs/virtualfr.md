# Юнибокс на стационарном компьютере

Юнибокс может быть использован при отсуствии микропк на любом компьютере
с операционной системой linux.

## Установка

Требования к компьютеру: операционная система семейства linux.

Конкретные команды приводятся только справочно, они могут быть изменены
под требования конкретной системы.

Порядок установки:

1. Создать каталог проекта со следующим набором файлов:

**cert.pem**            - криптосертификат
**key.pem**             - криптосертификат
**requirements.txt**    - файл зависимостей виртуального окружения
**storage.conf**        - файл конфигурации хранилища
**unibox-bin**          - исполняемый файл
**unibox_flox_4*.zip**  - библиотека версии не ниже flox-3

2. создать в любом удобном для себя месте следующие каталоги

**каталог для log файлов**
пустой

**каталог для хранения данных**
с подкаталогом config и файлами
**fr.conf**          - файл конфигурации фискального регистратора
**unibox.conf**      - основной файл конфигурации

3. создать и активировать виртуальное окружение для python2

mkdir ve
cd ve
virtualenv --python=$(which python2) unibox
source ~/ve/unibox/bin/activate

4. настроить зависимости виртуального окружения

pip install --upgrade pip
pip install -r ~/unibox/requirements.txt

5. получить серийный номер юнибокса для настройки кассы в Odoo

~/ve/unibox/bin/python unibox-bin --serial

следует обратить внимание, что при указании в odoo адреса юнибокса
необходимо указывать порт, т.к. веб интерфейс работает на нестандартном
порту

секция [pwi] опция port = 8000 файла конфигурации юнибокса

6. выполнить настройку файла конфигурации, минимальный перечень:

6.1. указать размещение данных storage.conf на каталоги созданные в п.2

[storage]
area = ./storage
mountable = False

6.2. указать размещение логов storage/config/unibox.conf на каталоги созданные в п.2

[options]
logfile = ./log/unibox.log

7. внести в настройку кассы Odoo серийный номер и адрес юнибокса п.5

8. запустить настроенный юнибокс

(unibox)> ./unibox-bin

9. остановка юнибокса из консоли может быть осуществлена многократным
нажатием сочетания клавиш Ctrl-C

10. если необходима работа как сервиса

скопировать unibox.service в /etc/systemd/system
использовать systemd команды start,stop,activate и status

пример:

sudo systemctl status unibox

## Тестирование

1. после запуска юнибокса контроль его работы осуществляется по логам

1.1. первая строка после старта выглядит так

UNIBOX серийный-номер started with flox v.2 from стартовый-каталог
